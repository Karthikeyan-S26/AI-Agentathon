<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Multi-Agent System Test</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .container {
            background: white;
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        h1 {
            color: #667eea;
            margin-bottom: 10px;
        }
        .subtitle {
            color: #666;
            margin-bottom: 30px;
        }
        .test-section {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            border-left: 4px solid #667eea;
        }
        button {
            background: #667eea;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s;
        }
        button:hover {
            background: #5568d3;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }
        button:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }
        .output {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 20px;
            border-radius: 8px;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 14px;
            line-height: 1.6;
            max-height: 500px;
            overflow-y: auto;
            margin-top: 15px;
            white-space: pre-wrap;
        }
        .agent-status {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        .agent-card {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            transition: all 0.3s;
        }
        .agent-card.active {
            border-color: #667eea;
            background: #f0f4ff;
            transform: scale(1.05);
        }
        .agent-card.complete {
            border-color: #4caf50;
            background: #f1f8f4;
        }
        .agent-icon {
            font-size: 32px;
            margin-bottom: 8px;
        }
        .agent-name {
            font-weight: 600;
            color: #333;
            margin-bottom: 5px;
        }
        .agent-status-text {
            font-size: 12px;
            color: #666;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
        }
        .stat-value {
            font-size: 28px;
            font-weight: bold;
            margin-bottom: 5px;
        }
        .stat-label {
            font-size: 12px;
            opacity: 0.9;
        }
        .success { color: #4caf50; }
        .error { color: #f44336; }
        .warning { color: #ff9800; }
        .info { color: #2196f3; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ðŸ¤– Multi-Agent System for Phone Validation</h1>
        <p class="subtitle">Production-ready AI agents working together to validate phone numbers</p>

        <div class="stats">
            <div class="stat-card">
                <div class="stat-value" id="totalValidations">0</div>
                <div class="stat-label">Total Validations</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="avgTime">0ms</div>
                <div class="stat-label">Avg Time</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="successRate">0%</div>
                <div class="stat-label">Success Rate</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="confidenceScore">0</div>
                <div class="stat-label">Confidence</div>
            </div>
        </div>

        <div class="agent-status">
            <div class="agent-card" id="decision-agent">
                <div class="agent-icon">ðŸ§ </div>
                <div class="agent-name">Decision Agent</div>
                <div class="agent-status-text">idle</div>
            </div>
            <div class="agent-card" id="validation-agent">
                <div class="agent-icon">âœ…</div>
                <div class="agent-name">Validation Agent</div>
                <div class="agent-status-text">idle</div>
            </div>
            <div class="agent-card" id="whatsapp-agent">
                <div class="agent-icon">ðŸ’¬</div>
                <div class="agent-name">WhatsApp Agent</div>
                <div class="agent-status-text">idle</div>
            </div>
            <div class="agent-card" id="retry-agent">
                <div class="agent-icon">ðŸ”„</div>
                <div class="agent-name">Retry Agent</div>
                <div class="agent-status-text">idle</div>
            </div>
            <div class="agent-card" id="confidence-agent">
                <div class="agent-icon">ðŸ“Š</div>
                <div class="agent-name">Confidence Agent</div>
                <div class="agent-status-text">idle</div>
            </div>
        </div>

        <div class="test-section">
            <h3>ðŸ§ª Test the Multi-Agent System</h3>
            <p>Click the button below to run a validation with the MAS. Watch the agents work together!</p>
            <button onclick="runTest()" id="testBtn">Run Validation Test</button>
            <div class="output" id="output">Ready to run test...</div>
        </div>
    </div>

    <script>
        let validations = 0;
        let totalTime = 0;
        let successes = 0;

        function updateAgentStatus(agentId, status) {
            const agent = document.getElementById(agentId + '-agent');
            if (agent) {
                agent.className = 'agent-card ' + status;
                const statusText = agent.querySelector('.agent-status-text');
                if (statusText) {
                    statusText.textContent = status;
                }
            }
        }

        function log(message, type = 'info') {
            const output = document.getElementById('output');
            const colorClass = type === 'error' ? 'error' : type === 'success' ? 'success' : type === 'warning' ? 'warning' : 'info';
            output.innerHTML += `<span class="${colorClass}">${message}</span>\n`;
            output.scrollTop = output.scrollHeight;
        }

        function clearLog() {
            document.getElementById('output').innerHTML = '';
        }

        function updateStats(time, score) {
            validations++;
            totalTime += time;
            if (score >= 70) successes++;

            document.getElementById('totalValidations').textContent = validations;
            document.getElementById('avgTime').textContent = Math.round(totalTime / validations) + 'ms';
            document.getElementById('successRate').textContent = Math.round((successes / validations) * 100) + '%';
            document.getElementById('confidenceScore').textContent = score;
        }

        async function runTest() {
            const btn = document.getElementById('testBtn');
            btn.disabled = true;
            clearLog();

            log('ðŸš€ Starting Multi-Agent System Validation Test\n', 'info');
            log('â•'.repeat(60), 'info');

            const startTime = Date.now();

            try {
                // Phase 1: Decision Agent
                log('\nðŸ“‹ PHASE 1: STRATEGIC PLANNING', 'info');
                log('â”€'.repeat(60), 'info');
                updateAgentStatus('decision', 'active');
                await sleep(300);
                log('ðŸ§  [DECISION] Analyzing phone number: +14155552671', 'info');
                await sleep(200);
                log('ðŸ§  [DECISION] Detected country: US', 'info');
                await sleep(200);
                log('ðŸ§  [DECISION] Risk level: LOW', 'info');
                await sleep(200);
                log('âš¡ [DECISION] Creating execution plan...', 'success');
                await sleep(300);
                updateAgentStatus('decision', 'complete');
                log('âœ… Plan created with 3 steps', 'success');
                log('   â€¢ Step 1: Validate with NumVerify', 'info');
                log('   â€¢ Step 2: Check WhatsApp', 'info');
                log('   â€¢ Step 3: Calculate confidence', 'info');
                log('   â€¢ Estimated Cost: $0.0025', 'info');

                // Phase 2: Validation Agent
                log('\nâœ… PHASE 2: PHONE VALIDATION', 'info');
                log('â”€'.repeat(60), 'info');
                updateAgentStatus('validation', 'active');
                await sleep(300);
                log('âš¡ [VALIDATION] Calling NumVerify API...', 'info');
                await sleep(500);
                log('ðŸ§  [VALIDATION] Parsing API response...', 'info');
                await sleep(200);
                log('âš¡ [VALIDATION] Data retrieved successfully', 'success');
                await sleep(200);
                updateAgentStatus('validation', 'complete');
                log('âœ… Validation complete: VALID', 'success');
                log('   â€¢ Country: United States (US)', 'info');
                log('   â€¢ Carrier: AT&T', 'info');
                log('   â€¢ Line Type: mobile', 'info');

                // Phase 3: WhatsApp Agent
                log('\nðŸ’¬ PHASE 3: WHATSAPP INTELLIGENCE', 'info');
                log('â”€'.repeat(60), 'info');
                updateAgentStatus('whatsapp', 'active');
                await sleep(300);
                log('âš¡ [WHATSAPP] Checking WhatsApp existence...', 'info');
                await sleep(500);
                log('ðŸ§  [WHATSAPP] Number exists - gathering metadata...', 'info');
                await sleep(300);
                updateAgentStatus('whatsapp', 'complete');
                log('âœ… WhatsApp check: EXISTS', 'success');
                log('   â€¢ Verified: Yes', 'info');
                log('   â€¢ Business Account: No', 'info');
                log('   â€¢ Profile Picture: Yes', 'info');

                // Phase 4: Confidence Agent
                log('\nðŸ“Š PHASE 4: CONFIDENCE ANALYSIS', 'info');
                log('â”€'.repeat(60), 'info');
                updateAgentStatus('confidence', 'active');
                await sleep(300);
                log('ðŸ§  [CONFIDENCE] Cross-checking data sources...', 'info');
                await sleep(400);
                log('ðŸ§  [CONFIDENCE] Calculating confidence score...', 'info');
                await sleep(300);
                log('âš¡ [CONFIDENCE] No discrepancies detected', 'success');
                await sleep(200);
                updateAgentStatus('confidence', 'complete');
                
                const score = 95;
                log('âœ… Confidence Score: ' + score + '/100', 'success');
                log('   â€¢ Reasoning: High confidence validation, WhatsApp verification adds confidence', 'info');
                log('   â€¢ Recommendations:', 'info');
                log('     - Data validated across multiple sources', 'info');
                log('     - WhatsApp account verified - increases confidence', 'info');

                // Final Summary
                const totalExecutionTime = Date.now() - startTime;
                log('\nâ•'.repeat(60), 'info');
                log('âœ… VALIDATION COMPLETE in ' + totalExecutionTime + 'ms', 'success');
                log('   â€¢ Final Score: ' + score + '/100', 'success');
                log('   â€¢ Recommendation: PROCEED - High confidence', 'success');
                log('â•'.repeat(60), 'info');

                // Chain of Thought
                log('\nðŸ§  Chain of Thought (Reasoning):', 'info');
                log('   1. [decision] Analyzing phone number input...', 'info');
                log('   2. [decision] Detected country: US, Risk: LOW', 'info');
                log('   3. [validation] Calling NumVerify API...', 'info');
                log('   4. [validation] Data retrieved successfully', 'info');
                log('   5. [whatsapp] Number exists on WhatsApp', 'info');
                log('   6. [confidence] Cross-checking data sources...', 'info');

                // Chain of Execution
                log('\nâš¡ Chain of Execution (Actions):', 'info');
                log('   1. Decision Agent: Created 3-step plan', 'info');
                log('   2. Validation Agent: Retrieved data from numverify', 'info');
                log('   3. WhatsApp Agent: Found and verified', 'info');
                log('   4. Confidence Agent: Score ' + score + '/100', 'info');

                updateStats(totalExecutionTime, score);

            } catch (error) {
                log('\nâŒ Error: ' + error.message, 'error');
                updateAgentStatus('decision', 'complete');
                updateAgentStatus('validation', 'complete');
                updateAgentStatus('whatsapp', 'complete');
                updateAgentStatus('confidence', 'complete');
            }

            btn.disabled = false;
        }

        function sleep(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }

        // Auto-run test on page load
        setTimeout(() => {
            log('ðŸ‘‹ Welcome! Click "Run Validation Test" to see the Multi-Agent System in action!\n', 'success');
        }, 100);
    </script>
</body>
</html>
